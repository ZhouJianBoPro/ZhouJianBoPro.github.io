---
layout: post
title: RocketMQ延迟消息
date: 2022-08-29
tags: [rocketmq]
---

#### 延迟级别
> RocketMQ支持有限级别的延迟消息，RocketMQ5.0之前不支持任意时间精度的定时消息。
> 共有18个延迟级别，分别对应1s、5s、10s、30s、1m、2m、3m、4m、5m、6m、7m、8m、9m、10m、20m、30m、1h、2h。

#### 延迟消息底层实现原理
> RocketMQ中，每个延迟级别都对应一个内部的Topic（SCHEDULE_TOPIC_XX，其中XX指的是延迟级别）。
> 当发送延迟消息时，消息先写入到对应延迟级别的队列中，然后Broker有定时线程负责检查延迟时间是否到期，
> 时间到期后，Broker会将延迟消息取出，并将消息投递到原始指定的目标Topic中

#### 如何发送自定义延迟时间/定时消息
> RocketMQ5.0 允许设置毫秒级别的延迟时间，同时也支持精确控制在某个时间点的消息投递
